/*
 * AngularJS Toaster
 * Version: 0.4.12
 *
 * Copyright 2013-2014 Jiri Kavulak.
 * All Rights Reserved.
 * Use, reproduction, distribution, and modification of this code is subject to the terms and
 * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
 *
 * Author: Jiri Kavulak
 * Related to project of John Papa and Hans Fj√§llemark
 */
(function(){angular.module("toaster",["ngAnimate"]).constant("toasterConfig",{limit:0,"tap-to-dismiss":true,"close-button":false,"newest-on-top":true,"time-out":5000,"icon-classes":{error:"toast-error",info:"toast-info",wait:"toast-wait",success:"toast-success",warning:"toast-warning"},"body-output-type":"","body-template":"toasterBodyTmpl.html","icon-class":"toast-info","position-class":"toast-top-right","title-class":"toast-title","message-class":"toast-message","prevent-duplicates":false,"mouseover-timer-stop":true}).service("toaster",["$rootScope","toasterConfig",function(a,c){this.pop=function(i,j,g,l,f,h,k,d){if(angular.isObject(i)){var e=i;this.toast={type:e.type,title:e.title,body:e.body,timeout:e.timeout,bodyOutputType:e.bodyOutputType,clickHandler:e.clickHandler,showCloseButton:e.showCloseButton};k=e.toasterId}else{this.toast={type:i,title:j,body:g,timeout:l,bodyOutputType:f,clickHandler:h,showCloseButton:d}}a.$emit("toaster-newToast",k)};this.clear=function(){a.$emit("toaster-clearToasts")};for(var b in c["icon-classes"]){this[b]=(function(d){return function(i,f,e,h,k,g,j){if(angular.isString(i)){this.pop(d,i,f,e,h,k,g,j)}else{this.pop(angular.extend(i,{type:d}))}}})(b)}}]).factory("toasterEventRegistry",["$rootScope",function(a){var e=null,d=null,f=[],c=[],b;b={setup:function(){if(!e){e=a.$on("toaster-newToast",function(k,h){for(var j=0,g=f.length;j<g;j++){f[j](k,h)}})}if(!d){d=a.$on("toaster-clearToasts",function(j){for(var h=0,g=c.length;h<g;h++){c[h](j)}})}},subscribeToNewToastEvent:function(g){f.push(g)},subscribeToClearToastsEvent:function(g){c.push(g)},unsubscribeToNewToastEvent:function(g){var h=f.indexOf(g);if(h>=0){f.splice(h,1)}if(f.length===0){e();e=null}},unsubscribeToClearToastsEvent:function(h){var g=c.indexOf(h);if(g>=0){c.splice(g,1)}if(c.length===0){d();d=null}}};return{setup:b.setup,subscribeToNewToastEvent:b.subscribeToNewToastEvent,subscribeToClearToastsEvent:b.subscribeToClearToastsEvent,unsubscribeToNewToastEvent:b.unsubscribeToNewToastEvent,unsubscribeToClearToastsEvent:b.unsubscribeToClearToastsEvent}}]).directive("toasterContainer",["$parse","$rootScope","$interval","$sce","toasterConfig","toaster","toasterEventRegistry",function(e,a,g,b,d,c,f){return{replace:true,restrict:"EA",scope:true,link:function(p,m,o){var h=0,n;n=angular.extend({},d,p.$eval(o.toasterOptions));p.config={toasterId:n["toaster-id"],position:n["position-class"],title:n["title-class"],message:n["message-class"],tap:n["tap-to-dismiss"],closeButton:n["close-button"],animation:n["animation-class"],mouseoverTimer:n["mouseover-timer-stop"]};p.$on("$destroy",function(){f.unsubscribeToNewToastEvent(p._onNewToast);f.unsubscribeToClearToastsEvent(p._onClearToasts)});function k(q,r){q.timeoutPromise=g(function(){p.removeToast(q.id)},r,1)}p.configureTimer=function(r){var q=angular.isNumber(r.timeout)?r.timeout:n["time-out"];if(q>0){k(r,q)}};function l(q){q.type=n["icon-classes"][q.type];if(!q.type){q.type=n["icon-class"]}if(n["prevent-duplicates"]===true&&p.toasters.length>0&&p.toasters[p.toasters.length-1].body===q.body){return}q.id=++h;var s=n["close-button"];if(typeof q.showCloseButton==="boolean"){}else{if(typeof s==="boolean"){q.showCloseButton=s}else{if(typeof s==="object"){var r=s[q.type];if(typeof r!=="undefined"&&r!==null){q.showCloseButton=r}}else{q.showCloseButton=false}}}q.bodyOutputType=q.bodyOutputType||n["body-output-type"];switch(q.bodyOutputType){case"trustedHtml":q.html=b.trustAsHtml(q.body);break;case"template":q.bodyTemplate=q.body||n["body-template"];break;case"templateWithData":var u=e(q.body||n["body-template"]);var t=u(p);q.bodyTemplate=t.template;q.data=t.data;break}p.configureTimer(q);if(n["newest-on-top"]===true){p.toasters.unshift(q);if(n.limit>0&&p.toasters.length>n.limit){p.toasters.pop()}}else{p.toasters.push(q);if(n.limit>0&&p.toasters.length>n.limit){p.toasters.shift()}}}p.removeToast=function(t){var s,r,q;for(s=0,r=p.toasters.length;s<r;s++){if(p.toasters[s].id===t){i(s);break}}};function i(r){var q=p.toasters[r];if(q){if(q.timeoutPromise){g.cancel(q.timeoutPromise)}p.toasters.splice(r,1)}}function j(){for(var q=p.toasters.length;q>=0;q--){i(q)}}p.toasters=[];p._onNewToast=function(r,q){if(p.config.toasterId===undefined&&q===undefined||q!==undefined&&q===p.config.toasterId){l(c.toast)}};p._onClearToasts=function(q){j()};f.setup();f.subscribeToNewToastEvent(p._onNewToast);f.subscribeToClearToastsEvent(p._onClearToasts)},controller:["$scope","$element","$attrs",function(j,i,h){j.stopTimer=function(k){if(j.config.mouseoverTimer===true){if(k.timeoutPromise){g.cancel(k.timeoutPromise);k.timeoutPromise=null}}};j.restartTimer=function(k){if(j.config.mouseoverTimer===true){if(!k.timeoutPromise){j.configureTimer(k)}}else{if(k.timeoutPromise===null){j.removeToast(k.id)}}};j.click=function(k){if(j.config.tap===true||k.showCloseButton===true){var l=true;if(k.clickHandler){if(angular.isFunction(k.clickHandler)){l=k.clickHandler(k,k.showCloseButton)}else{if(angular.isFunction(j.$parent.$eval(k.clickHandler))){l=j.$parent.$eval(k.clickHandler)(k,k.showCloseButton)}else{console.log("TOAST-NOTE: Your click handler is not inside a parent scope of toaster-container.")}}}if(l){j.removeToast(k.id)}}}}],template:'<div id="toast-container" ng-class="[config.position, config.animation]"><div ng-repeat="toaster in toasters" class="toast" ng-class="toaster.type" ng-click="click(toaster)" ng-mouseover="stopTimer(toaster)" ng-mouseout="restartTimer(toaster)"><button type="button" class="toast-close-button" ng-show="toaster.showCloseButton" ng-click="click(toaster)">&times;</button><div ng-class="config.title">{{toaster.title}}</div><div ng-class="config.message" ng-switch on="toaster.bodyOutputType"><div ng-switch-when="trustedHtml" ng-bind-html="toaster.html"></div><div ng-switch-when="template"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="templateWithData"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-default >{{toaster.body}}</div></div></div></div>'}}])})(window,document);